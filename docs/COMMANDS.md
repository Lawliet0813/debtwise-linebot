# 指令與格式

透過下列指令即可與 DebtWise Bot 互動。所有參數皆以半形空白分隔，若遇到錯誤，Bot 會回傳提示並附上快速回覆。

## /add – 新增債務

- **格式**：`/add <名稱> <本金> <利率%> d=<到期日> [min=<最低還款>]`
- **範例**：`/add 卡費 50000 14.9% d=25 min=1500`
- **說明**：
  - 本金與利率需為數字，利率使用百分比表示。
  - `d=` 參數為必填，範圍 1–31；`min=` 可省略，預設為 0。
- **常見錯誤**：
  - 缺少 `d=` 參數。
  - 利率或金額非數字。
  - 同名債務已存在（同一使用者僅能有一筆同名債務）。

## /list – 債務清單

- **格式**：`/list`
- **說明**：
  - 以 Flex Carousel 顯示債務名稱、已還金額、剩餘餘額、利率與到期日。
  - 超過 10 筆僅顯示前 9 筆並附加「…還有 N 筆」提示。
  - 若無資料會出現空狀態卡片，並提醒使用 `/add` 建立債務。

## /pay – 紀錄還款

- **格式**：`/pay <債務名稱> <金額> [YYYY-MM-DD] [備註...]`
- **範例**：`/pay 卡費 3500 2024-10-05 自動扣款`
- **說明**：
  - 金額需為正數；日期可省略（預設今日），亦支援 `MM/DD`、`MM-DD` 等短格式。
  - 備註為選填，會原樣儲存在 Supabase。
- **常見錯誤**：
  - 尚未新增該債務。
  - 金額不是數字或為負數。

## /plan – 還款計畫

- **格式**：`/plan <月預算> [雪球|雪崩]`
- **範例**：`/plan 20000 雪崩`
- **說明**：
  - 預設採用雪崩法（高利率優先），可改用雪球法（餘額小者優先）。
  - 系統會計算每月最低還款、分配剩餘預算並估算總利息。
  - 結果包含文字摘要與一張 Flex 卡片（顯示月預算、總月數、第一個月的分配）。
- **限制**：
  - 若月預算不足以支付所有債務的最低還款，會要求調整金額。

## 常見提醒

- Bot 每分鐘對同一 `userId` 最多處理 15 次訊息，超過會回覆「操作太頻繁」。
- 指令失敗或格式錯誤時，訊息內建快速回覆，可直接點選重新輸入。
- 所有資料均存於 Supabase，建議使用 service role 以外的 anon key。
